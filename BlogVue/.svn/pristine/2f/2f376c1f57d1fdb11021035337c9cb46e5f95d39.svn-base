<template>
  <!-- <div
        style=" width: 300px;min-height: 300px;background: white;position: relative;"
        id="bingtu" draggable="true"
  ></div>-->
  <div class="df" style="width:100%">
    <div style="min-width:400px;height:250px;" :id="id" class="b"></div>
  </div>
</template>

<script>
export default {
  name: "HelloWorld",
  props: {
    msg: String,
    id: String,
    data: Array,
    textValue: {
      type: Number,
      default: () => {
        return 249;
      }
    },
    text: {
      type: String
    }
  },
  data() {
    return {
      echarts: "",
      showData: [], //展示的名字
      releData: [] //展示的数据
    };
  },
  created() {
    const _this = this;
    _this.resetRing();
  },
  mounted() {
    this.initecharts();
    console.log(process.env.NODE_ENV);
  },
  methods: {
    resetRing() {
      const _this = this;
      _this.showData = [];
      _this.releData = [];
      for (let i = 0; i < _this.data.length; i++) {
        let obj = {
          name: _this.data[i].name,
          icon: "circle"
        };
        let obj1 = {
          value: _this.data[i].value,
          name: _this.data[i].name
        };
        _this.showData.push(obj);
        _this.releData.push(obj1);
      }
    },
    initecharts() {
      const _this = this;
      this.echarts = require("echarts");
      var myChart = this.echarts.init(
        document.getElementById(this.id), //初始化的div  ID
        "macarons"
      );
      var option = {
        color: [
          "#2DC7C9",
          "#FFBA7F",
          "#BDAAE1",
          "#F57770",
          "#2F9323",
          "#D9B63A",
          "#2E2AA4",
          "#9F2E61",
          "#4D670C",
          "#BF675F",
          "#1F814A",
          "#357F88",
          "#673509",
          "#310937",
          "#1B9637",
          "#F7393C"
        ],
        tooltip: {
          trigger: "item",
          formatter: "{a} <br/>{b} : {c} ({d}%)"
        },
        // 下标（颜色代表的参数）
        legend: {
          bottom: 10,
          data: _this.showData
        },
        graphic: [
          {
            type: "text",
            left: "center",
            top: "35%",
            style: {
              text: `${_this.textValue}`,
              textAlign: "center",
              fill: "#3E81E4",

              fontSize: 18
            }
          },
          {
            type: "text",
            left: "center",
            top: "center",
            style: {
              text: `${_this.text}`,
              textAlign: "center",
              fill: "#000",
              fontSize: 14
            }
          }
        ],
        series: [
          {
            name: "访问来源",
            type: "pie",
            avoidLabelOverlap: false,
            radius: ["50%", "70%"],
            center: ["50%", "45%"],
            // 圆上的指示线
            data: _this.releData,
            itemStyle: {
              normal: {
                label: {
                  show: true,
                  formatter: "{b} : {c}"
                },
                labelLine: { show: true }
              }
            },
            emphasis: {
              itemStyle: {
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowColor: "rgba(0, 0, 0, 0.5)"
              }
            }
          }
        ]
      };
      myChart.setOption(option);
    }
  }
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
h3 {
  margin: 40px 0 0;
}
ul {
  list-style-type: none;
  padding: 0;
}
li {
  display: inline-block;
  margin: 0 10px;
}
a {
  color: #42b983;
}
</style>
