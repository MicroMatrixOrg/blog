<template>
  <div>
    <div class="leftmenu">
      <!-- <ul v-if="showType == 1">
            <li v-for="(item,index) in pathList" :key="index" :class="{'active':item.id==activeMod}">
                <router-link :to="item.path"><i :class="['iconfont',item.icon]" style="margin-right: 10px;"></i>{{item.name}}</router-link>   
            </li>
      </ul>-->

      <ul>
        <li @click="openMiss=!openMiss" v-if="showType==0||showType==2">
          <a>
            <i class="iconfont iconrenwu"></i>
            <span style=" font-size: 18px;">小任务</span>
            <Icon
              type="ios-arrow-down"
              :class="[openMiss?'rotateUp':'rotateDown']"
              style="position: relative;top: 3px;left: 30px;"
            />
          </a>
        </li>

        <li
          @click="locToMiss('/mission')"
          :class="{'active':'/mission'==path}"
          v-if="(showType==0||showType==2)&&openMiss"
        >
          <a style="padding: 18px 0px 18px 90px;">
            <!-- <i class="iconfont iconrenwu"></i> -->
            <span style=" font-size: 16px;">小任务</span>
          </a>
        </li>

        <li @click="locToMiss('/mission')" :class="{'active':'/mission'==path}" v-if="showType==1">
          <a style>
            <i class="iconfont iconrenwu"></i>
            <span style=" font-size: 18px;">我的任务</span>
          </a>
        </li>

        <li
          v-if="(showType == 0||showType == 2)&&openMiss"
          @click="locToMiss('/statisticsMain')"
          :class="{'active':'/statisticsMain'==path}"
          style="font-size:18px;"
        >
          <a style="padding: 18px 0px 18px 90px;">
            <!-- <i class="iconfont  iconqushi " style="font-size: initial;vertical-align: top;margin-right:10px;"></i> -->
            统计分析
          </a>
        </li>

        <li @click="openDisc=!openDisc" v-if="showType==0||showType==2">
          <a>
            <i class="iconfont icontaolun"></i>
            <span style=" font-size: 18px;">小讨论</span>
            <Icon
              type="ios-arrow-down"
              :class="[openDisc?'rotateUp':'rotateDown']"
              style="position: relative;top: 3px;left: 30px;"
            />
          </a>
        </li>

        <li
          @click="locToDisc('/discussionManager')"
          :class="{'active':'/discussionManager'==activeName}"
          v-if="openDisc&&(showType==0||showType==2)"
        >
          <a style="padding: 18px 0px 18px 90px;">讨论管理</a>
        </li>
        <li
          @click="locToDisc('/dReleManager')"
          :class="{'active':'/dReleManager'==activeName}"
          v-if="openDisc&&(showType==0||showType==2)"
        >
          <a style="    padding: 18px 0px 18px 90px;">发布管理</a>
        </li>

        <li
          @click="locToDisc('/stuDiscussion')"
          :class="{'active':'/stuDiscussion'==activeName}"
          v-if="(showType==1)"
        >
          <a style>
            <i class="iconfont icontaolun"></i>
            <span style=" font-size: 18px;">我的讨论</span>
          </a>
        </li>

        <li @click="loc('/mytest')" v-if="showType==1" :class="{'active':'/mytest'==path}">
          <a>
            <i class="iconfont icon-chakantiezishijian"></i>
            <span style=" font-size: 18px;">我的测验</span>
          </a>
        </li>
        <li @click="open=!open" v-if="showType==0||showType==2">
          <a>
            <i :class="['iconfont','icon-chakantiezishijian']"></i>
            <span style="    font-size: 18px;">小测验</span>
            <Icon
              type="ios-arrow-down"
              :class="[open?'rotateUp':'rotateDown']"
              style=" position: relative;top: 3px;left: 30px;"
            />
          </a>
        </li>
        <li :class="{'active':'/productManage'==path}" v-if="open&&(showType==0||showType==2)">
          <a @click="loc('/productManage')" style="    padding: 18px 0px 18px 90px;">发布管理</a>
        </li>
        <li :class="{'active':'/expaper'==path}" v-if="open&&(showType==0||showType==2)">
          <a @click="loc('/expaper')" style="    padding: 18px 0px 18px 90px;">试卷库</a>
        </li>
        <li :class="{'active':'/problems'==path}" v-if="open&&(showType==0||showType==2)">
          <a @click="loc('/problems')" style="    padding: 18px 0px 18px 90px;">试题库</a>
        </li>

        <li @click="loc(item.path)" class="cp" v-for="(item,index) in pathList3" :key="index">
          <a style="font-size:18px;">
            <i :class="['iconfont',item.icon]" style="margin-right: 10px;"></i>
            {{item.name}}
          </a>
        </li>
      </ul>

      <!-- <Menu v-if="showType == 0 || showType == 2"   @click="loc"    theme="light" @on-select="selectItem" :active-name="activeName" :openDisc-names='openName.length ? ["discussion"] : openName'>
            <Submenu v-for="(item,index) in pathList" :key="index" :name="item.path">
                <template slot="title">
                    <i :class="['iconfont',item.icon]" ></i>
                    {{item.name}}
                </template>
                <MenuItem    v-for="(item2,index2) in item.children" :key="index2" :name="item2.path"  :class="{'active':item2.path==activeName}" > {{item2.name}} </MenuItem>
            </Submenu>
      </Menu>-->
    </div>
  </div>
</template>
<script>
import router from "../router/index.js";
import myStorge from "../utils/localStorge.js";

export default {
  props: {
    showType: {
      type: Number
    },
    pathList3: {
      type: Array
    }
  },
  data() {
    return {
      path: "",
      pathList: [],
      statisticsList: [],
      activeMod: "",
      activeName: "",
      openName: [],
      onepathList: [],

      //
      pathList1: [
        { name: "作业讲解", id: "2", path: "/myfile", icon: "icon-people" }
      ],
      pathList2: [
        {
          name: "作业讲解",
          id: "2",
          path: "/stuanalysis",
          icon: "icon-people"
        }
      ],

      openDisc: false,
      openMiss: false,
      open: false
    };
  },
  mounted() {
    const _this = this;
    this.activeName =
      this.pathList == 0
        ? null
        : this.pathList[0].children.length == 0
        ? this.pathList[0].path
        : this.pathList[0].children[0].path;

    // this.getUserInfo();
    // let a = [2];
    // console.log(typeof a.find(item => item == 3) == "undefined");
    // Student(3, "学生"), Teacher(1, "教师"), Tourist(0,"游客"),SchLeader(2,"校领导"),Parent(4,"家长"),AreaLeader(5,"局领导");
  },
  watch: {
    $route(router, from) {
      const _this = this;
      let activePath = router.meta.activePath;
      let activeId = router.meta.activeId;
      _this.activeMod = router.meta.activeId;
      if (typeof activeId == "undefined" || typeof activePath == "undefined") {
        activePath = router.path;
        _this.activeMod = router.meta.modId;
      }
      _this.activeName = activePath;
      console.log(router);

      // _this.$set(router, from);

      if (
        _this.activeName == "/discussionManager" ||
        _this.activeName == "/dReleManager"
      ) {
        this.openDisc = true;
      } else {
        this.openDisc = false;
      }

      this.getLeftMenu();
    }
  },
  created() {
    // this.getLeftMenu();
    // this.getUserInfo();
    // this.$router.push(name);
  },
  methods: {
    locToMiss(path) {
      // window.location = window.location.origin + "/gongju/#" + path;
      window.location.href =
        window.location.origin + `${window.linkTypeMap.gongju}` + path;
    },
    locToDisc(path) {
      // window.location = window.location.origin + "/discussion/#" + path;
      window.location.href =
        window.location.origin + `${window.linkTypeMap.discussion}` + path;
    },
    loc(path) {
      // window.location = window.location.origin + "/zuoye/#" + path;
      window.location.href =
        window.location.origin + `${window.linkTypeMap.zuoye}` + path;
    },
    selectItem(name) {
      this.$router.push(name);
      // console.log(name);
    },
    getLeftMenu() {
      //获取侧边栏及选中侧边栏
      this.path = this.$route.path;
    }
  }
};
</script>
<style lang="scss" scoped>
.leftmenu {
  position: fixed;
  z-index: 20;
  -moz-overflow: auto;
  overflow: auto;
  overflow: overlay;
  overflow-x: hidden;
  background: #f6f6f6;
  height: 100%;
  width: 240px;
  box-sizing: border-box;
  padding-top: 15px;
  & > div {
    overflow-y: auto;
  }
  border-right: 1px solid #eaeaea;
  ul {
    background: #f6f6f6;
    width: 240px;
    overflow: overlay;
    border-right: 0px;
    display: block;
    margin: 0;
    padding: 0;
    outline: 0;
    list-style: none;
    // padding-top: 15px;

    position: relative;
    li {
      text-align: center;
      background: #f6f6f6;
      padding: 0px;
      &.active {
        background: #e5e5e5;
        a {
          color: #333;
        }
      }
      a {
        color: #333;
        display: block;
        padding: 18px 0px 18px 54px;
        box-sizing: border-box;
        text-align: left;
        font-size: 16px;
        outline: none;
      }
      a:hover {
        background: #e5e5e5;
      }
      i {
        font-size: 20px;
        margin: 5px;
        vertical-align: bottom;
      }
    }
  }
}

.ivu-menu-vertical .ivu-menu-item:hover,
.ivu-menu-vertical .ivu-menu-submenu-title:hover {
  background: #e5e5e5;
}
.ivu-menu-item {
  padding: 18px 0px 18px 54px !important;
}
.ivu-menu-vertical .ivu-menu-item:hover,
.ivu-menu-vertical .ivu-menu-submenu-title:hover {
  color: #333;
}
.ivu-menu-light.ivu-menu-vertical .ivu-menu-item-active:not(.ivu-menu-submenu) {
  color: #333;
  background: #e5e5e5;
  z-index: 2;
}
.ivu-menu-light.ivu-menu-vertical
  .ivu-menu-item-active:not(.ivu-menu-submenu):after {
  content: "";
  display: block;
  width: 2px;
  position: absolute;
  top: 0;
  bottom: 0;
  right: 0;
  background: #e5e5e5;
}

* /deep/ .ivu-menu-vertical .ivu-menu-submenu-title:hover {
  color: #333;
}
* /deep/ .ivu-menu-submenu-title {
  font-size: 17px;
  padding: 18px 0px 18px 54px !important ;
  text-align: left;
}
.ivu-menu-submenu-title-icon {
  left: 107px !important;
  top: 35px !important;
  right: 0;
}
.rotateUp {
  transform: rotate(180deg);
  transition: transform ease 0.3s;
}
.rotateDown {
  transform: rotate(0deg);
  transition: transform ease 0.3s;
}
</style>
