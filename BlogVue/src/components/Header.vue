<template>
  <div class="toolbar-header-wrap">
    <div class="m-content-theme toolbar-header">
      <div class="m-icon-theme-default">
        <svg
          width="60"
          height="40"
          viewBox="0 0 186 130"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
        >
          <title>Matrix</title>
          <defs>
            <polygon
              id="path-1"
              points="18.845574 24.125929 40.0587774 2.91272556 115.012096 77.8660444 93.7988928 99.0792478"
            ></polygon>
            <filter
              x="-0.5%"
              y="-0.5%"
              width="101.0%"
              height="102.1%"
              filterUnits="objectBoundingBox"
              id="filter-2"
            >
              <feOffset
                dx="0"
                dy="1"
                in="SourceAlpha"
                result="shadowOffsetOuter1"
              ></feOffset>
              <feComposite
                in="shadowOffsetOuter1"
                in2="SourceAlpha"
                operator="out"
                result="shadowOffsetOuter1"
              ></feComposite>
              <feColorMatrix
                values="0 0 0 0 1   0 0 0 0 0   0 0 0 0 0  0 0 0 1 0"
                type="matrix"
                in="shadowOffsetOuter1"
              ></feColorMatrix>
            </filter>
            <polygon
              id="path-3"
              points="148.51968 3.08326112 169.916739 24.2597317 94.3137977 99.0832611 72.9167389 77.9067905"
            ></polygon>
            <filter
              x="-0.5%"
              y="-0.5%"
              width="101.0%"
              height="102.1%"
              filterUnits="objectBoundingBox"
              id="filter-4"
            >
              <feOffset
                dx="0"
                dy="1"
                in="SourceAlpha"
                result="shadowOffsetOuter1"
              ></feOffset>
              <feComposite
                in="shadowOffsetOuter1"
                in2="SourceAlpha"
                operator="out"
                result="shadowOffsetOuter1"
              ></feComposite>
              <feColorMatrix
                values="0 0 0 0 1   0 0 0 0 0   0 0 0 0 0  0 0 0 1 0"
                type="matrix"
                in="shadowOffsetOuter1"
              ></feColorMatrix>
            </filter>
            <polygon id="path-5" points="4 3 40 3 40 125 4 125"></polygon>
            <filter
              x="-18.1%"
              y="-4.5%"
              width="136.1%"
              height="110.7%"
              filterUnits="objectBoundingBox"
              id="filter-6"
            >
              <feOffset
                dx="0"
                dy="1"
                in="SourceAlpha"
                result="shadowOffsetOuter1"
              ></feOffset>
              <feGaussianBlur
                stdDeviation="2"
                in="shadowOffsetOuter1"
                result="shadowBlurOuter1"
              ></feGaussianBlur>
              <feComposite
                in="shadowBlurOuter1"
                in2="SourceAlpha"
                operator="out"
                result="shadowBlurOuter1"
              ></feComposite>
              <feColorMatrix
                values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.5 0"
                type="matrix"
                in="shadowBlurOuter1"
              ></feColorMatrix>
            </filter>
            <polygon id="path-7" points="146 3 182 3 182 125 146 125"></polygon>
            <filter
              x="-18.1%"
              y="-4.5%"
              width="136.1%"
              height="110.7%"
              filterUnits="objectBoundingBox"
              id="filter-8"
            >
              <feOffset
                dx="0"
                dy="1"
                in="SourceAlpha"
                result="shadowOffsetOuter1"
              ></feOffset>
              <feGaussianBlur
                stdDeviation="2"
                in="shadowOffsetOuter1"
                result="shadowBlurOuter1"
              ></feGaussianBlur>
              <feComposite
                in="shadowBlurOuter1"
                in2="SourceAlpha"
                operator="out"
                result="shadowBlurOuter1"
              ></feComposite>
              <feColorMatrix
                values="0 0 0 0 0   0 0 0 0 0   0 0 0 0 0  0 0 0 0.5 0"
                type="matrix"
                in="shadowBlurOuter1"
              ></feColorMatrix>
            </filter>
          </defs>
          <g
            id="页面-1"
            stroke="none"
            stroke-width="1"
            fill="none"
            fill-rule="evenodd"
          >
            <g id="矩形">
              <use
                fill="black"
                fill-opacity="1"
                filter="url(#filter-2)"
                xlink:href="#path-1"
              ></use>
              <path
                stroke="#FF0000"
                stroke-width="1"
                d="M40.0587774,3.61983234 L114.304989,77.8660444 L93.7988928,98.372141 L19.5526808,24.125929 L40.0587774,3.61983234 Z"
                stroke-linejoin="square"
                fill="#FF0000"
                fill-rule="evenodd"
              ></path>
            </g>
            <g id="矩形">
              <use
                fill="black"
                fill-opacity="1"
                filter="url(#filter-4)"
                xlink:href="#path-3"
              ></use>
              <path
                stroke="#FF0000"
                stroke-width="1"
                d="M148.51968,3.78673246 L169.20594,24.2597317 L94.3137977,98.3797898 L73.627538,77.9067905 L148.51968,3.78673246 Z"
                stroke-linejoin="square"
                fill="#FF0000"
                fill-rule="evenodd"
              ></path>
            </g>
            <g id="矩形">
              <use
                fill="black"
                fill-opacity="1"
                filter="url(#filter-6)"
                xlink:href="#path-5"
              ></use>
              <path
                stroke="#000000"
                stroke-width="1"
                d="M39.5,3.5 L39.5,124.5 L4.5,124.5 L4.5,3.5 L39.5,3.5 Z"
                stroke-linejoin="square"
                fill="#000000"
                fill-rule="evenodd"
              ></path>
            </g>
            <g id="矩形">
              <use
                fill="black"
                fill-opacity="1"
                filter="url(#filter-8)"
                xlink:href="#path-7"
              ></use>
              <path
                stroke="#000000"
                stroke-width="1"
                d="M181.5,3.5 L181.5,124.5 L146.5,124.5 L146.5,3.5 L181.5,3.5 Z"
                stroke-linejoin="square"
                fill="#000000"
                fill-rule="evenodd"
              ></path>
            </g>
          </g>
        </svg>
      </div>
      <ul class="m-routers-theme-default header-tabs">
        <li class="m-router-theme-default">
          <ul role="tab" class="m-router-ul-theme-default  phone-hide">
            <li class="nav-item link-item">首页</li>
          </ul>
        </li>
        <li class="m-person-theme-default add">
          <div class="search-form-theme-default">
            <searchbtn></searchbtn>
          </div>
          <div class="add-btn-group">
            <button class="add-blog">写文章</button>
          </div>
        </li>
      </ul>
    </div>
  </div>
</template>
<script>
import searchbtn from "@/components/input/Input.vue";
export default {
  name: "Header",
  components: {
    searchbtn
  },
  data() {
    var validateName = (rule, value, callback) => {
      if (value == "") {
        callback(new Error("请输入用户名"));
      }
      callback();
    };

    var validateEmail = (rule, value, callback) => {
      if (value == "") {
        callback(new Error("请输入邮箱"));
      } else {
        if (this.form.email !== "") {
          let pattern = /^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/;
          if (pattern.test(value)) {
            callback();
          } else {
            callback(new Error("请输入正确的邮箱格式"));
          }
        }
      }
    };

    var validatePass = (rule, value, callback) => {
      if (value === "") {
        callback(new Error("请输入密码"));
      } else {
        if (this.form.checkPass !== "") {
          this.$refs.ruleForm.validateField("checkPass");
        }
        callback();
      }
    };
    var validatePass2 = (rule, value, callback) => {
      if (value === "") {
        callback(new Error("请再次输入密码"));
      } else if (value !== this.form.password) {
        callback(new Error("两次输入密码不一致!"));
      } else {
        callback();
      }
    };
    return {
      hasLogin: false,
      user: {
        username: "请先登录",
        avatar:
          "https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png"
      },
      blogs: {},
      currentPage: 1,
      total: 0,
      dialogVisible: false,

      form: {
        name: "",
        email: "",
        password: "",
        checkPass: "",
        verifiCode: ""
      },
      rules: {
        name: [{ validator: validateName, trigger: "blur" }],
        password: [{ validator: validatePass, trigger: "blur" }],
        checkPass: [{ validator: validatePass2, trigger: "blur" }],
        email: [{ validator: validateEmail, trigger: "blur" }]
      },
      formLabelWidth: "120px"
    };
  },
  methods: {
    handleClose() {},
    open() {
      const _this = this;
      _this.dialogVisible = true;
    },

    /**
     * @description: 验证
     * @param {String}
     * @return {Boolean}
     * @Date: 2020-10-10 16:28:58
     * @Author: David
     */

    verificationCode() {},

    /**
     * @description: 注册
     * @Date: 2020-08-08 10:57:54
     * @Author: David
     */

    register() {
      const _this = this;
      // console.log(_this.form);
      let params = {
        username: _this.form.name,
        password: _this.form.password,
        email: _this.form.email
      };

      this.$axios.post(APIConfig.Base.Register, params).then(res => {
        if (res.data.code == 200) {
          _this.$message({
            message: "恭喜你，注册成功",
            type: "success"
          });

          _this.dialogVisible = false;
          _this.form = {
            name: "",
            email: "",
            password: "",
            checkPass: ""
          };
        }
      });
    },
    /**
     * @description: 退出
     * @Date: 2020-08-08 10:57:47
     * @Author: David
     */

    logout() {
      const _this = this;
      this.$axios
        .get(APIConfig.Base.Logout, {
          headers: {
            Authorization: localStorage.getItem("token")
          }
        })
        .then(res => {
          _this.$store.commit("REMOVE_INFO");
          _this.$router.push("/loginPage");
        });
    },

    /**
     * @description: 发表文章
     * @Date: 2020-09-27 17:22:24
     * @Author: David
     */

    release() {
      let path = this.routerCfg.options.pathById(21);
      this.$router.push(path);
    },

    login() {
      let path = this.routerCfg.options.pathById(1);
      this.$router.push(path);
    },

    goMain() {
      let path = this.routerCfg.options.pathById(2);
      this.$router.push(path);
    }
  },
  created() {
    if (this.$store.getters.getUser.username) {
      this.user.username = this.$store.getters.getUser.username;
      this.user.avatar = this.$store.getters.getUser.avatar;
      this.hasLogin = true;
    }
  }
};
</script>

<style lang="scss" scoped>
.toolbar-header-wrap {
  background-color: #fff;
}
.toolbar-header {
  display: flex;
  align-items: center;
  justify-content: space-around;

  max-width: 960px;
  margin: 0 auto;
}

.m-router-ul-theme-default {
  li {
    list-style: none;
  }
}

.header-tabs {
  display: flex;
  align-items: center;
}

.phone-hide {
  display: flex;
}

.nav-item {
  color: #71777c;
  padding: 0 1.2rem;
  font-size: 1.33rem;
  justify-content: center;
  cursor: pointer;

  display: flex;
  align-items: center;
  height: 100%;
  margin: 0;
}

.link-item {
  padding: 0 1.5rem;
  height: 5rem;
}

.add {
  display: flex;
}

.add-btn-group {
  display: flex;
  align-items: center;
  position: relative;
  height: 2.667rem;
  cursor: pointer;
}

.add-blog {
  padding: 0 0.9rem;
  font-size: 1.167rem;
  border-top-right-radius: 0;
  border-bottom-right-radius: 0;

  height: 100%;
  color: #fff;
  background-color: #007fff;
  border-radius: 3px;

  border: 1px solid #007fff;
}
</style>
